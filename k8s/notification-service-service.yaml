apiVersion: v1
kind: Service
metadata:
  name: notification-service
  namespace: ufs
  labels:
    app: notification-service
    tier: backend
    component: notification
    service-type: microservice
    business-domain: communication
    compliance-level: high
    version: v1
    part-of: unified-financial-services
    managed-by: argocd
  annotations:
    # Service discovery and networking
    service.alpha.kubernetes.io/tolerate-unready-endpoints: "false"
    
    # Prometheus monitoring configuration
    prometheus.io/scrape: "true"
    prometheus.io/port: "3000"
    prometheus.io/path: "/metrics"
    prometheus.io/scheme: "http"
    
    # Service mesh configuration (Istio)
    sidecar.istio.io/inject: "true"
    traffic.sidecar.istio.io/includeInboundPorts: "3000"
    traffic.sidecar.istio.io/excludeOutboundPorts: ""
    
    # Kong Gateway integration
    konghq.com/service-path: "/notification"
    konghq.com/strip-path: "true"
    konghq.com/preserve-host: "true"
    
    # Load balancing and traffic policies
    service.kubernetes.io/load-balancer-class: "kong"
    networking.istio.io/exportTo: "*"
    
    # Security and compliance annotations
    security.financial.io/data-classification: "internal"
    compliance.financial.io/audit-required: "true"
    security.financial.io/encryption-required: "true"
    
    # Performance and SLA annotations
    performance.financial.io/target-response-time: "500ms"
    sla.financial.io/availability-target: "99.9%"
    
    # Documentation and contact information
    documentation.kubernetes.io/description: "Notification Service for unified financial services platform - handles real-time notifications, alerts, and communication workflows"
    contact.kubernetes.io/team: "platform-services"
    contact.kubernetes.io/slack: "#notification-service"
    
    # Deployment and lifecycle annotations
    deployment.kubernetes.io/revision: "1"
    argocd.argoproj.io/sync-wave: "2"
    argocd.argoproj.io/compare-options: "ServerSideDiff=true"
    
    # Financial services specific annotations
    fintech.platform.io/service-category: "notification"
    fintech.platform.io/risk-level: "medium"
    fintech.platform.io/data-retention: "7years"
    regulatory.compliance.io/frameworks: "SOC2,PCI-DSS,GDPR"
    
spec:
  type: ClusterIP
  selector:
    app: notification-service
  ports:
    - name: http
      protocol: TCP
      port: 80
      targetPort: 3000
      appProtocol: http
    - name: health
      protocol: TCP
      port: 8080
      targetPort: 8080
      appProtocol: http
    - name: metrics
      protocol: TCP
      port: 9090
      targetPort: 3000
      appProtocol: http
  sessionAffinity: None
  
  # Internal traffic policy for cluster-internal communication
  internalTrafficPolicy: Cluster
  
  # IP families configuration for dual-stack support
  ipFamilyPolicy: SingleStack
  ipFamilies:
    - IPv4
    
status:
  loadBalancer: {}